#!/bin/bash

echo "üöÄ –ó–∞–ø—É—Å–∫ VPN —Å–∞–π—Ç–∞..."

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pkill -f "php -S" 2>/dev/null

# –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É webapp
cd "$(dirname "$0")"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å PHP —Å–µ—Ä–≤–µ—Ä –≤ —Ñ–æ–Ω–µ
nohup php -S localhost:8000 index.php > server.log 2>&1 &

# –ü–æ–¥–æ–∂–¥–∞—Ç—å –∑–∞–ø—É—Å–∫–∞
sleep 3

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É
if curl -s http://localhost:8000 > /dev/null 2>&1; then
    clear
    echo "‚úÖ VPN —Å–∞–π—Ç –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ!"
    echo ""
    echo "üåê –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: http://localhost:8000"
    echo ""
    echo "üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:"
    echo "   1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä"
    echo "   2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: http://localhost:8000"
    echo "   3. –í—ã–±–µ—Ä–∏—Ç–µ VPN —Å–µ—Ä–≤–µ—Ä"
    echo "   4. –ù–∞–∂–º–∏—Ç–µ CONNECT"
    echo "   5. –ì–æ—Ç–æ–≤–æ!"
    echo ""
    echo "üéØ –ï—Å–ª–∏ —Å—Ç–∏–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è:"
    echo "   - –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5)"
    echo "   - –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞"
    echo "   - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π –±—Ä–∞—É–∑–µ—Ä"
    echo ""
    echo "‚ú® –°–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ http://localhost:8000"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞"
    echo "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª–µ server.log"
fi